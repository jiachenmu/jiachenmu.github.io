<!DOCTYPE html>
          <head>
        <meta charset="utf-8">
            
            <title>
                iOSåˆ©ç”¨Runtimeå†™ä¸€ä¸ªJsonè½¬Modelçš„å·¥å…· | ManoBooçš„æŠ€æœ¯å°çª
            </title>
            <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport">
            <meta name="theme-color" content="#4184f3">
            
            
            <link href="/favicon.ico" rel="icon"/>
            

            <link rel="stylesheet" href="/css/highlight.light.css">
            <link rel="stylesheet" href="/css/nav-icon.css">
            <link rel="stylesheet" href="/css/waves.min.css">
            <link rel="stylesheet" href="/css/jquery.tocify.css">
            <link rel="stylesheet" href="/css/main.css">
            <link rel="stylesheet" href="/css/nav-indicator.css">
            
  

  
            </meta>
        </meta>
    </head>
    <body>
        <header>
            <!-- cover image or sth. -->
        </header>
        <div id="main" class="m-scene">
            <div class="nav-wrapper" style="background-color:undefined">
    <div class="container">
        <nav>
            <div class="logo wave">
                <a href="/" id="logo">
                    ManoBooçš„æŠ€æœ¯å°çª
                </a>
            </div>
            <div class="nav-toggle-icon" >
                <div class="material-hamburger">
                    <span>
                    </span>
                    <span>
                    </span>
                    <span>
                    </span>
                </div>
            </div>
            <div class="menu-wrapper">
                <div class="nav-indicator">
                </div>
                <ul class="menus">
                    
                     
                        <li>
                            <a class="wave " href="/">
                                Home
                            </a>
                        </li>
                     
                        <li>
                            <a class="wave " href="/archives">
                                Archive
                            </a>
                        </li>
                     
                        <li>
                            <a class="wave " href="/about">
                                About
                            </a>
                        </li>
                     
                        <li>
                            <a class="wave no-smoothstate" href="/atom.xml">
                                RSS
                            </a>
                        </li>
                     
                    
                   
                </ul>
            </div>
        </nav>
    </div>
</div>
            <div class="container content">
                <div class="scene_element scene_element--fadein">
                    <div class="row">
    <div class="main">
        <article>
          
          <header class="post-header">
          
          </header>
          <h1 class="post-title">iOSåˆ©ç”¨Runtimeå†™ä¸€ä¸ªJsonè½¬Modelçš„å·¥å…·</h1>

          <section class="post-info">
            <span class="post-date">2016/7/19</span>
            
            
            <span class="post-tags">
              <ul class="post-tag-list"><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/CMModel-JSONè½¬Modelå·¥å…·/">CMModel JSONè½¬Modelå·¥å…·</a></li></ul>
            </span>
            
          </section>

          <section class="post-content">
            <hr>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="#å‰è¨€"></a>#å‰è¨€</h2><h2 id="å¥½ä¹…æ²¡æœ‰å†™è¿‡æ–°æ–‡ç« äº†ï¼Œæœ€è¿‘ä¸€ç›´åœ¨å¿™å·¥ä½œçš„äº‹æƒ…ï¼Œæˆ‘çš„æ–°æµªå¾®åšå¼€æºé¡¹ç›®ä¹Ÿåœæ­¢äº†ä¸€å‘¨æ—¶é—´ï¼Œç›®å‰å®Œæˆäº†60-ï¼Œå°±å…ˆå†™ä¸€ç¯‡å…³äºJSONè½¬Modelçš„æ–‡ç« å’Œå¤§å®¶èŠèŠå¤©å§ï¼Œä¸ºä»€ä¹ˆä¼šå†™ä¸€ä¸ªè¿™ä¸ªå°å·¥å…·å‘¢ï¼Œè¯·çœ‹æ–‡æœ«ğŸ˜„"><a href="#å¥½ä¹…æ²¡æœ‰å†™è¿‡æ–°æ–‡ç« äº†ï¼Œæœ€è¿‘ä¸€ç›´åœ¨å¿™å·¥ä½œçš„äº‹æƒ…ï¼Œæˆ‘çš„æ–°æµªå¾®åšå¼€æºé¡¹ç›®ä¹Ÿåœæ­¢äº†ä¸€å‘¨æ—¶é—´ï¼Œç›®å‰å®Œæˆäº†60-ï¼Œå°±å…ˆå†™ä¸€ç¯‡å…³äºJSONè½¬Modelçš„æ–‡ç« å’Œå¤§å®¶èŠèŠå¤©å§ï¼Œä¸ºä»€ä¹ˆä¼šå†™ä¸€ä¸ªè¿™ä¸ªå°å·¥å…·å‘¢ï¼Œè¯·çœ‹æ–‡æœ«ğŸ˜„" class="headerlink" title="###å¥½ä¹…æ²¡æœ‰å†™è¿‡æ–°æ–‡ç« äº†ï¼Œæœ€è¿‘ä¸€ç›´åœ¨å¿™å·¥ä½œçš„äº‹æƒ…ï¼Œæˆ‘çš„æ–°æµªå¾®åšå¼€æºé¡¹ç›®ä¹Ÿåœæ­¢äº†ä¸€å‘¨æ—¶é—´ï¼Œç›®å‰å®Œæˆäº†60%ï¼Œå°±å…ˆå†™ä¸€ç¯‡å…³äºJSONè½¬Modelçš„æ–‡ç« å’Œå¤§å®¶èŠèŠå¤©å§ï¼Œä¸ºä»€ä¹ˆä¼šå†™ä¸€ä¸ªè¿™ä¸ªå°å·¥å…·å‘¢ï¼Œè¯·çœ‹æ–‡æœ«ğŸ˜„"></a>###å¥½ä¹…æ²¡æœ‰å†™è¿‡æ–°æ–‡ç« äº†ï¼Œæœ€è¿‘ä¸€ç›´åœ¨å¿™å·¥ä½œçš„äº‹æƒ…ï¼Œæˆ‘çš„æ–°æµªå¾®åšå¼€æºé¡¹ç›®ä¹Ÿåœæ­¢äº†ä¸€å‘¨æ—¶é—´ï¼Œç›®å‰å®Œæˆäº†60%ï¼Œå°±å…ˆå†™ä¸€ç¯‡å…³äºJSONè½¬Modelçš„æ–‡ç« å’Œå¤§å®¶èŠèŠå¤©å§ï¼Œä¸ºä»€ä¹ˆä¼šå†™ä¸€ä¸ªè¿™ä¸ªå°å·¥å…·å‘¢ï¼Œè¯·çœ‹æ–‡æœ«ğŸ˜„</h2><h2 id="æ ¸å¿ƒæ–¹æ³•Runtimeçš„ä»‹ç»"><a href="#æ ¸å¿ƒæ–¹æ³•Runtimeçš„ä»‹ç»" class="headerlink" title="#æ ¸å¿ƒæ–¹æ³•Runtimeçš„ä»‹ç»"></a>#æ ¸å¿ƒæ–¹æ³•Runtimeçš„ä»‹ç»</h2><p>##1. Runtimeæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>é¡¾åæ€ä¹‰ï¼šRuntimeå°±æ˜¯è¿è¡Œæ—¶çš„æ„æ€ï¼Œæ˜¯ç³»ç»Ÿåœ¨è¿è¡Œæ—¶çš„ä¸€äº›æœºåˆ¶ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„å°±æ˜¯æ¶ˆæ¯æœºåˆ¶ï¼Œä¸¾ä¸ªå¸¸ç”¨çš„ä¾‹å­ï¼Œåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­è¨€ä¸­ï¼Œä¸‡ç‰©çš†å¯¹è±¡ï¼Œå¯¹è±¡å¦‚ä½•è°ƒç”¨æ–¹æ³•å‘¢ï¼Œ<br><code>[target excuteSEL]</code>,éœ€è¦ä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦ä¸€ä¸ªæ–¹æ³•åï¼Œç³»ç»Ÿåœ¨è¿è¡Œæ—¶ä¼šè‡ªåŠ¨è½¬æ¢æˆä»¥ä¸‹çš„å½¢å¼ï¼š<br><code>objc_msgSend(target,@selector(excuteSEL:))</code></p>
<p>å…³äºRuntimeçš„è¯¦ç»†ä»‹ç»ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šæè¿°äº†ã€‚</p>
<hr>
<p>##2.Runtimeçš„å¸¸è§ç”¨æ³•<br>æ³¨:ä½¿ç”¨æ—¶éœ€è¦<code>#import &lt;objc/objc-runtime.h&gt;</code></p>
<h3 id="1-æ–¹æ³•æ›¿æ¢-é»‘é­”æ³•"><a href="#1-æ–¹æ³•æ›¿æ¢-é»‘é­”æ³•" class="headerlink" title="* 1 æ–¹æ³•æ›¿æ¢(é»‘é­”æ³•)"></a>* 1 æ–¹æ³•æ›¿æ¢(é»‘é­”æ³•)</h3><p>ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼š<br>å°†è°ƒç”¨Aæ–¹æ³•æ›¿æ¢ä¸ºè°ƒç”¨Bæ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">class_replaceMethod([self class], @selector(sendAMessage:), (IMP)changeAtoB, NULL);</div><div class="line"></div><div class="line">//MARK: æ–¹æ³•æ›¿æ¢_1</div><div class="line">- (void)sendAMessage:(NSString *)message &#123;</div><div class="line">    NSLog(@&quot;A_message: %@&quot;,message);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)sendBMessage:(NSString *)message &#123;</div><div class="line">    NSLog(@&quot;B_Message: %@&quot;,message);</div><div class="line">&#125;</div><div class="line"></div><div class="line">ViewController * changeAtoB(ViewController *SELF, SEL _cmd, NSString *message) &#123;</div><div class="line">   </div><div class="line">    if ([NSStringFromSelector(_cmd) isEqualToString:@&quot;sendAMessage:&quot;]) &#123;</div><div class="line">        //å°†æ–¹æ³•è¿›è¡Œæ›¿æ¢</div><div class="line">        [SELF sendBMessage:message];</div><div class="line">    &#125;</div><div class="line">    return SELF;</div><div class="line">&#125;</div><div class="line">//è¿™é‡ŒIMPå¯ä»¥ç†è§£ä¸ºé­”æ³•é€šé“ï¼Œå°†æºæ–¹æ³•é€šè¿‡IMPæŒ‡é’ˆè½¬æ¢ä¸ºç›®æ ‡æ–¹æ³•</div></pre></td></tr></table></figure></p>
<h3 id="2-è·å–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•"><a href="#2-è·å–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•" class="headerlink" title="* 2 è·å–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•"></a>* 2 è·å–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•</h3><p>æ³¨ï¼šè·å–å¯¹è±¡çš„å±æ€§ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨JSONè½¬Modelå¯ä»¥è¯´æ˜¯æ ¸å¿ƒæ–¹æ³•äº†<br>ä¸¾ä¾‹è¯´æ˜ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//class_copyPropertyList è¿™ä¸ªæ–¹æ³•ä¼šè·å–åˆ°ä¸€ä¸ªç±».hå’Œ.mæ–‡ä»¶ä¸­interfaceä¸­çš„æ‰€æœ‰å±æ€§</div><div class="line"></div><div class="line">//è·å–CMGCDç±»çš„å±æ€§åç§°</div><div class="line">    unsigned int count;</div><div class="line">    objc_property_t *propertyList = class_copyPropertyList([CMGCD class], &amp;count);</div><div class="line">    for (unsigned int i = 0; i &lt; count; i++) &#123;</div><div class="line">        const char *propertyName = property_getName(propertyList[i]);</div><div class="line">        NSLog(@&quot;property ---&gt; %@&quot;,[NSString stringWithUTF8String:propertyName]);</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//</div><div class="line">unsigned int count;</div><div class="line">Method *methodList = class_copyMethodList([CMGCD class], &amp;count);</div><div class="line">    for (unsigned int i; i &lt; count; i++) &#123;</div><div class="line">        Method method = methodList[i];</div><div class="line">        NSLog(@&quot;Method ---&gt; %@&quot;,NSStringFromSelector(method_getName(method)));</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="2-è®¾ç½®å¯¹è±¡å…³è”"><a href="#2-è®¾ç½®å¯¹è±¡å…³è”" class="headerlink" title="* 2 è®¾ç½®å¯¹è±¡å…³è”"></a>* 2 è®¾ç½®å¯¹è±¡å…³è”</h3><p>å®šä¹‰ï¼šå…³è”æ˜¯æŒ‡æŠŠä¸¤ä¸ªå¯¹è±¡ç›¸äº’å…³è”èµ·æ¥ï¼Œä½¿å…¶ä¸­çš„ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå¦å¤–ä¸€ä¸ªå¯¹è±¡çš„ä¸€éƒ¨åˆ†<br>å†ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘åœ¨å¯¹è±¡ä¸­å®šä¹‰äº†ä¸€ä¸ªå±æ€§<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@property (strong, nonatomic) NSString *content;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//è®¾ç½®å¯¹è±¡å±æ€§å…³è”</div><div class="line">static char associatedKey;</div><div class="line">    objc_setAssociatedObject(self, &amp;associatedKey, @&quot;content_yeah&quot;, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</div><div class="line">    NSString *get_content = objc_getAssociatedObject(self, &amp;associatedKey);</div><div class="line">    NSLog(@&quot;content = %@&quot;,get_content);</div></pre></td></tr></table></figure>
<p><strong>Tips:</strong>è®¾ç½®å¯¹è±¡å…³è”éœ€è¦ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š<br><code>æºå¯¹è±¡</code>ã€<code>å…³é”®å­—</code>ã€<code>å…³è”çš„å¯¹è±¡</code> <code>å…³è”ç­–ç•¥</code><br><strong>è§£é‡Šä¸€ä¸‹ï¼š</strong>è¿™é‡Œæˆ‘å°†<code>@&quot;content_yeah&quot;</code>è¿™ä¸ªå¯¹è±¡ä¸<code>self</code>ä½¿ç”¨<code>OBJC_ASSOCIATION_RETAIN_NONATOMIC</code>ç­–ç•¥å…³è”åˆ°ä¸€èµ·ï¼Œæ„æ€å°±æ˜¯åœ¨<code>self</code>çš„ç”Ÿå‘½å‘¨æœŸä¹‹å†…å…³è”çš„å¯¹è±¡éƒ½ä¸ä¼šè¢«é‡Šæ”¾ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å®ç°åŠ¨æ€å‘ç±»é‡Œé¢æ·»åŠ å±æ€§<br>å¦å¤–è¿˜æœ‰ä¸€äº›å…³è”çš„æ–¹æ³•ï¼Œå¦‚</p>
<ul>
<li><p>æ–­å¼€å…³è”ï¼š è®¾ç½®å…³è”å¯¹è±¡ä¸º<code>nil</code>å³å¯<br><code>objc_setAssociatedObject(self, &amp;associatedKey, nil, OBJC_ASSOCIATION_RETAIN_NONATOMIC);</code></p>
</li>
<li><p>æ–­å¼€è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å…³è”å…³ç³»</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//æ–­å¼€æ‰€æœ‰å…³è”</div><div class="line">    objc_removeAssociatedObjects(self);</div></pre></td></tr></table></figure>
<hr>
<p>#JSONè½¬Modelå·¥å…·çš„ä¸»è¦ä»‹ç»</p>
<hr>
<h2 id="1-ä¸ºä»€ä¹ˆä¼šå†™è¿™æ ·ä¸€ä¸ªå·¥å…·"><a href="#1-ä¸ºä»€ä¹ˆä¼šå†™è¿™æ ·ä¸€ä¸ªå·¥å…·" class="headerlink" title="1. ä¸ºä»€ä¹ˆä¼šå†™è¿™æ ·ä¸€ä¸ªå·¥å…·"></a>1. ä¸ºä»€ä¹ˆä¼šå†™è¿™æ ·ä¸€ä¸ªå·¥å…·</h2><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸æ˜¯ç¼ºå°‘å®åŠ›ï¼Œè€Œä¸”æ˜¯ç¼ºå°‘ä¸€ç§<strong><code>å½¼å¯å–è€Œä»£ä¹‹</code></strong>çš„å‹‡æ°”ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰<code>MJExtension</code>ã€<code>YYModel</code>çš„äº§ç”Ÿ,æŸ¥çœ‹æºä»£ç çš„è¿‡ç¨‹ä¸­æˆ‘æœ‰ç§æƒ³æ­»çš„æ„Ÿè§‰ï¼Œä½†æ˜¯çŸ¥é“å®ç°çš„åŸç†åï¼Œä¸ºä»€ä¹ˆä¸èƒ½è‡ªå·±å»å®ç°ä¸€ä¸ªå‘¢ï¼Ÿè¿™ä¸ªå·¥å…·çš„æºä»£ç éå¸¸ç®€å•ï¼Œæˆ‘å†™è¿™ä¸ªå·¥å…·çš„ç›®çš„åªæ˜¯ä¸ºäº†å‘Šè¯‰æœ‹å‹ä»¬ï¼ŒçœŸçš„ä¸å¤æ‚ï¼Œä¸è¦å› ä¸ºçœ‹ç€å¤æ‚å°±æ”¾å¼ƒäº†è‡ªå·±åŠ¨æ‰‹çš„å†²åŠ¨</p>
<h2 id="2-å·¥å…·çš„æ•´ä½“æ­¥éª¤ç®€ä»‹"><a href="#2-å·¥å…·çš„æ•´ä½“æ­¥éª¤ç®€ä»‹" class="headerlink" title="2. å·¥å…·çš„æ•´ä½“æ­¥éª¤ç®€ä»‹"></a>2. å·¥å…·çš„æ•´ä½“æ­¥éª¤ç®€ä»‹</h2><p>ç€é‡ä»‹ç»ä¸€ä¸‹æˆ‘çš„æ€è€ƒè¿‡ç¨‹</p>
<ul>
<li>1 æ ¸å¿ƒæ–¹æ³•ï¼Ÿ<br> åˆ©ç”¨Runtimeå¯ä»¥éå†å‡ºå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œç„¶ååˆ©ç”¨é€’å½’çš„æ€æƒ³é€å±‚è§£æJSON</li>
<li>2 æ€ä¹ˆå»åšï¼Ÿ<br> åŸºæœ¬æ‰€æœ‰çš„Modelç»§æ‰¿<code>NSObject</code>ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª<code>NSObject</code>çš„<code>Category</code>ï¼Œç„¶ååœ¨å…¶ä¸­å†™ä¸€äº›è§£ææ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯¹ç…§JSONå­—ç¬¦ä¸²çš„è§£æè·¯å¾„å­—å…¸ï¼Œæ¯”å¦‚è¯´<code>JSON</code>çš„<code>ç‹—</code>çš„å±æ€§åç§°ä¸º<code>dog</code>,æˆ‘ä»¬çš„å¯¹è±¡å±æ€§åç§°æƒ³å®šä¹‰ä¸º<code>xiaogou</code>ï¼Œè¿™å°±éœ€è¦æ‰‹å†™ä¸€ä¸ªå­—å…¸å°†è§£æä¸­é‡åˆ°çš„<code>dog</code>éƒ½ç»™æ˜ å°„ä¸º<code>xiaogou</code></li>
<li>3 å¼€å§‹åŠ¨æ‰‹å§</li>
</ul>
<hr>
<h2 id="3-ä¸»è¦ä»£ç ä»‹ç»ï¼š"><a href="#3-ä¸»è¦ä»£ç ä»‹ç»ï¼š" class="headerlink" title="3. ä¸»è¦ä»£ç ä»‹ç»ï¼š"></a>3. ä¸»è¦ä»£ç ä»‹ç»ï¼š</h2><hr>
<h3 id="1-NSObject-CMModel-ä»‹ç»"><a href="#1-NSObject-CMModel-ä»‹ç»" class="headerlink" title="* 1 NSObject+CMModel ä»‹ç»"></a>* 1 <code>NSObject+CMModel</code> ä»‹ç»</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//NSObject+CMModel.h </div><div class="line">// å•ä¸ªå¯¹è±¡</div><div class="line">- (NSDictionary *)dict_CMModelWithClass;</div><div class="line"></div><div class="line">// å¯¹è±¡æ•°ç»„</div><div class="line">- (NSDictionary *)dict_CMModelWIthArrayClass;</div><div class="line"></div><div class="line">- (instancetype)cm_initWithJSONString:(NSString *)jsonString;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢ç€é‡è§£é‡Šä¸€ä¸‹.mæ–‡ä»¶ä¸­çš„å†…å®¹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">//NSObject+CMModel.m</div><div class="line">#import &lt;objc/runtime.h&gt;</div><div class="line">#import &quot;CMObject.h&quot;</div><div class="line">#import &quot;CMProperty.h&quot;</div><div class="line"></div><div class="line">//è¿”å›å•ä¸ªå¯¹è±¡çš„è§£æå­—å…¸ï¼Œé»˜è®¤ä¸ºnil</div><div class="line">- ( NSDictionary * _Nullable )dict_CMModelWithClass &#123;</div><div class="line">    return nil;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//è¿”å›å¯¹è±¡æ•°ç»„çš„è§£æå­—å…¸ï¼Œé»˜è®¤ä¸ºnil</div><div class="line">- (NSDictionary *)dict_CMModelWIthArrayClass &#123;</div><div class="line">    return nil;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//è°ƒç”¨æ–¹æ³•</div><div class="line">- (instancetype)cm_initWithJSONString:(NSString *)jsonString &#123;</div><div class="line">    if (self) &#123;</div><div class="line">        [self analysisWitnJsonString:jsonString];</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> <strong>å–å¾—å¯¹è±¡çš„æ‰€æœ‰å±æ€§åŠå…¶å¯¹åº”çš„ç±»å‹</strong><br> Tips: è¿™é‡Œè‡ªå·±å†™äº†ä¸€ä¸ªç±»ï¼Œå°†å¯¹è±¡çš„å±æ€§åŠå…¶åç§°å°è£…åˆ°ä¸€ä¸ªç±»å‹ä¸º<code>CMProperty</code>çš„æ•°ç»„</p>
<ul>
<li>1 <strong>CMPropertyç±»ç®€ä»‹</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//å±æ€§åç§°</div><div class="line">@property (strong, nonatomic) NSString *propertyName;</div><div class="line"></div><div class="line">//å±æ€§çš„ç±»</div><div class="line">@property (strong, nonatomic) Class propertyClass;</div><div class="line"></div><div class="line">//æ˜¯å¦åŸºæœ¬ç±»å‹</div><div class="line">@property (assign, nonatomic) BOOL isBasicType;</div></pre></td></tr></table></figure>
<ul>
<li>2 <strong>è·å–å¯¹è±¡å±æ€§åŠå…¶ç±»å‹ï¼Œå¹¶ä¸”å°†å…¶å°è£…ä¸ºç±»å‹ä¸º<code>CMProperty</code>çš„æ•°ç»„</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"> //å°†è¯¥ç±»çš„å±æ€§å’Œå¯¹åº”çš„ç±»å‹è¿›è¡Œå°è£…</div><div class="line">- (NSArray &lt;CMProperty *&gt; *)propertyArray &#123;</div><div class="line">    NSMutableArray *propertyArray = [NSMutableArray array];</div><div class="line">    </div><div class="line">    unsigned int count;</div><div class="line">    objc_property_t *propertyList = class_copyPropertyList([self class], &amp;count);</div><div class="line">    for (unsigned int i = 0; i &lt; count; i++) &#123;</div><div class="line">        CMProperty *property = [[CMProperty alloc] init];</div><div class="line">        property.propertyName = [NSString stringWithUTF8String:property_getName(propertyList[i])];</div><div class="line">        </div><div class="line">        NSString *attrs = @(property_getAttributes(propertyList[i]));</div><div class="line"></div><div class="line">        NSUInteger dotLoc = [attrs rangeOfString:@&quot;,&quot;].location;</div><div class="line">        NSString *propertyType = nil;</div><div class="line">        NSUInteger loc = 1;</div><div class="line">        if (dotLoc == NSNotFound) &#123; // æ²¡æœ‰æ‰¾åˆ°</div><div class="line">            propertyType = [attrs substringFromIndex:loc];</div><div class="line">        &#125;else &#123;</div><div class="line">            propertyType = [attrs substringWithRange:NSMakeRange(loc, dotLoc - loc)];</div><div class="line">            if ([propertyType isEqualToString:@&quot;Q&quot;]) &#123;</div><div class="line">                //åŸºæœ¬ç±»å‹</div><div class="line">                property.isBasicType = true;</div><div class="line">            &#125;else &#123;</div><div class="line">                propertyType = [propertyType substringWithRange:NSMakeRange(2, propertyType.length - 3)];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        property.propertyClass = NSClassFromString(propertyType);</div><div class="line">    </div><div class="line">        [propertyArray addObject:property];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    free(propertyList);</div><div class="line">    </div><div class="line">    return propertyArray;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>å¼€å§‹è§£æ</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">//è¿›è¡Œè§£æ</div><div class="line">- (void)analysisWitnJsonString:(NSString *)json &#123;</div><div class="line">    </div><div class="line">    //å­˜åœ¨è§£æå­—å…¸</div><div class="line">    if ([self dict_CMModelWithClass] != nil || [self dict_CMModelWIthArrayClass] != nil) &#123;</div><div class="line">        CMObject *analysisTools = [[CMObject alloc] initWithGoalObject:self CMPropertyArray:[self propertyArray]];</div><div class="line">        if ([self dict_CMModelWIthArrayClass]) &#123;</div><div class="line">            analysisTools.analysisObjectArrayDict = [self dict_CMModelWIthArrayClass];</div><div class="line">        &#125;</div><div class="line">        if ([self dict_CMModelWithClass]) &#123;</div><div class="line">            analysisTools.analysisDict = [self dict_CMModelWithClass];</div><div class="line">        &#125;</div><div class="line">        analysisTools.jsonString = json;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-CMObject-ä»‹ç»"><a href="#2-CMObject-ä»‹ç»" class="headerlink" title="* 2 CMObject ä»‹ç»"></a>* 2 <code>CMObject</code> ä»‹ç»</h3><p>è¿™ä¸ªç±»ä¸ºå®é™…è¿›è¡Œè§£æå·¥å…·çš„ç±»ï¼Œæˆ–è€…å¯ä»¥ç§°ä¹‹ä¸ºå·¥å…·,è¿™é‡Œæˆ‘ä»¬éœ€è¦ç‰¹æ®Šå¯¹å¾…<code>NSArray</code>ã€<code>NSDictionary</code>ã€<code>intã€floatç­‰åŸºæœ¬ç±»å‹</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">//CMObject.h</div><div class="line"></div><div class="line">//è¦è§£æçš„å¯¹è±¡</div><div class="line">@property (strong, nonatomic) id object;</div><div class="line"></div><div class="line">//è§£ækeyå¯¹åº”åˆ—è¡¨ å•ä¸ªå¯¹è±¡</div><div class="line">@property (strong, nonatomic) NSDictionary *analysisDict;</div><div class="line"></div><div class="line">//è§£ækeyå¯¹åº”åˆ—è¡¨ å¯¹è±¡æ•°ç»„</div><div class="line">@property (strong, nonatomic) NSDictionary *analysisObjectArrayDict;</div><div class="line"></div><div class="line">//å±æ€§åˆ—è¡¨</div><div class="line">@property (strong, nonatomic) NSArray &lt;CMProperty *&gt; *propertyArray;</div><div class="line"></div><div class="line">//initæ–¹æ³•</div><div class="line">- (instancetype)initWithGoalObject:(id)object CMPropertyArray:(NSArray &lt;CMProperty *&gt; *)propertyArray;</div><div class="line"></div><div class="line">//è§£æçš„æºJSON</div><div class="line">@property (strong, nonatomic) NSString *jsonString;</div><div class="line"></div><div class="line"></div><div class="line">BOOL Exist_(id obj,NSArray *existArray);</div></pre></td></tr></table></figure>
<p><strong>Tips:</strong> ä¸‹é¢ä»£ç å¯èƒ½çœ‹ç€ä¼šä¸èˆ’æœï¼Œæˆ‘è¯´ä¸€ä¸‹æ•´ä½“çš„æ€è·¯</p>
<h4 id="1-NSObject-CMModelä¸­å°†å°è£…çš„å±æ€§æ•°ç»„ä¼ é€’è¿‡æ¥ï¼Œæˆ‘ä»¬ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å¯¹å±æ€§è¿›è¡Œéå†æ„é€ "><a href="#1-NSObject-CMModelä¸­å°†å°è£…çš„å±æ€§æ•°ç»„ä¼ é€’è¿‡æ¥ï¼Œæˆ‘ä»¬ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å¯¹å±æ€§è¿›è¡Œéå†æ„é€ " class="headerlink" title="* 1 NSObject+CMModelä¸­å°†å°è£…çš„å±æ€§æ•°ç»„ä¼ é€’è¿‡æ¥ï¼Œæˆ‘ä»¬ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å¯¹å±æ€§è¿›è¡Œéå†æ„é€ "></a>* 1 <code>NSObject+CMModel</code>ä¸­å°†å°è£…çš„å±æ€§æ•°ç»„ä¼ é€’è¿‡æ¥ï¼Œæˆ‘ä»¬ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å¯¹å±æ€§è¿›è¡Œéå†æ„é€ </h4><h4 id="2-éå†è¯¦è§£ï¼šä¸¾ä¾‹ï¼Œç¢°åˆ°NSArrayçš„å±æ€§æ—¶ï¼Œæˆ‘ä»¬å»çœ‹è¦è§£æçš„ç±»ä¸­å®ç°çš„-NSDictionary-dict-CMModelWIthArrayClassè¿™ä¸ªæ–¹æ³•ï¼Œæ‰¾åˆ°ç›®çš„å¯¹è±¡çš„ç±»å‹OBJClassï¼Œç„¶åå°†JSONå­—å…¸æ‹†åˆ†ååˆ©ç”¨-instancetype-cm-initWithJSONString-NSString-jsonStringè¿™ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªOBJClassç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œåˆ›å»ºå®Œåï¼Œä½¿ç”¨KVC-å°†æ•°ç»„èµ‹ç»™æºå¯¹è±¡ï¼Œå…·ä½“ä»£ç çœ‹ä¸‹é¢"><a href="#2-éå†è¯¦è§£ï¼šä¸¾ä¾‹ï¼Œç¢°åˆ°NSArrayçš„å±æ€§æ—¶ï¼Œæˆ‘ä»¬å»çœ‹è¦è§£æçš„ç±»ä¸­å®ç°çš„-NSDictionary-dict-CMModelWIthArrayClassè¿™ä¸ªæ–¹æ³•ï¼Œæ‰¾åˆ°ç›®çš„å¯¹è±¡çš„ç±»å‹OBJClassï¼Œç„¶åå°†JSONå­—å…¸æ‹†åˆ†ååˆ©ç”¨-instancetype-cm-initWithJSONString-NSString-jsonStringè¿™ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªOBJClassç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œåˆ›å»ºå®Œåï¼Œä½¿ç”¨KVC-å°†æ•°ç»„èµ‹ç»™æºå¯¹è±¡ï¼Œå…·ä½“ä»£ç çœ‹ä¸‹é¢" class="headerlink" title=" 2 éå†è¯¦è§£ï¼šä¸¾ä¾‹ï¼Œç¢°åˆ°NSArrayçš„å±æ€§æ—¶ï¼Œæˆ‘ä»¬å»çœ‹è¦è§£æçš„ç±»ä¸­å®ç°çš„`- (NSDictionary )dict_CMModelWIthArrayClassè¿™ä¸ªæ–¹æ³•ï¼Œæ‰¾åˆ°ç›®çš„å¯¹è±¡çš„ç±»å‹OBJClassï¼Œç„¶åå°†JSONå­—å…¸æ‹†åˆ†ååˆ©ç”¨- (instancetype)cm_initWithJSONString:(NSString *)jsonStringè¿™ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªOBJClassç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œåˆ›å»ºå®Œåï¼Œä½¿ç”¨KVC`å°†æ•°ç»„èµ‹ç»™æºå¯¹è±¡ï¼Œå…·ä½“ä»£ç çœ‹ä¸‹é¢"></a><em> 2 éå†è¯¦è§£ï¼šä¸¾ä¾‹ï¼Œç¢°åˆ°<code>NSArray</code>çš„å±æ€§æ—¶ï¼Œæˆ‘ä»¬å»çœ‹è¦è§£æçš„ç±»ä¸­å®ç°çš„`- (NSDictionary </em>)dict_CMModelWIthArrayClass<code>è¿™ä¸ªæ–¹æ³•ï¼Œæ‰¾åˆ°ç›®çš„å¯¹è±¡çš„ç±»å‹</code>OBJClass<code>ï¼Œç„¶åå°†</code>JSONå­—å…¸<code>æ‹†åˆ†ååˆ©ç”¨</code>- (instancetype)cm_initWithJSONString:(NSString *)jsonString<code>è¿™ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ª</code>OBJClass<code>ç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œåˆ›å»ºå®Œåï¼Œä½¿ç”¨</code>KVC`å°†æ•°ç»„èµ‹ç»™æºå¯¹è±¡ï¼Œå…·ä½“ä»£ç çœ‹ä¸‹é¢</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">//CMObject.m</div><div class="line">//è¿™é‡Œè¯´ä¸€ä¸‹è§£ææ–¹æ³•, ä»£ç è¾ƒå¤š</div><div class="line">//å¼€å§‹è¿›è¡Œmodelè§£æ</div><div class="line">- (void)analysisModel &#123;</div><div class="line">    NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:[_jsonString dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingAllowFragments error:nil];</div><div class="line"></div><div class="line">    //å°†`NSObject+CMModel`ä¸­è·å–çš„å±æ€§æ•°ç»„è¿›è¡Œéå†æ„é€ ï¼Œå¹¶èµ‹å€¼ç»™å¯¹åº”çš„å±æ€§</div><div class="line">    [_propertyArray enumerateObjectsUsingBlock:^(CMProperty * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;</div><div class="line">        //å•ç‹¬å¤„ç†æ•°ç»„ç±»å‹</div><div class="line">        if (obj.propertyClass == [NSArray class]) &#123;</div><div class="line">            //Â Â å¯¹è±¡ä¸ºæ•°ç»„ç±»å‹ï¼Œ</div><div class="line">            NSString *key = [_analysisObjectArrayDict objectForKey:obj.propertyName];</div><div class="line"></div><div class="line">            Class OBJClass = NSClassFromString(key);</div><div class="line">        </div><div class="line">            if (![jsonDict objectForKey:key]) &#123;</div><div class="line">                //åç§°ä¸jsonä¸­çš„åç§°å¹¶ä¸ç›¸ç¬¦</div><div class="line">                if ([_analysisDict objectForKey:obj.propertyName]) &#123;</div><div class="line">                    NSMutableArray *objectArray = [NSMutableArray array];</div><div class="line">                    </div><div class="line">                    NSArray *obj_json_array = [jsonDict objectForKey:[_analysisDict objectForKey:obj.propertyName]];</div><div class="line">                    [obj_json_array enumerateObjectsUsingBlock:^(NSDictionary   * _Nonnull obj_dict, NSUInteger idx, BOOL * _Nonnull stop) &#123;</div><div class="line">                        id objx = [[OBJClass alloc] cm_initWithJSONString:DataToJSONString(obj_dict)];</div><div class="line">                        //è§£æå¥½å¯¹è±¡ä¹‹åï¼Œå­˜åˆ°æ•°æ®ä¸­</div><div class="line">                        [objectArray addObject:objx];</div><div class="line">                        </div><div class="line">                    &#125;];</div><div class="line">                    [_object setValue:objectArray forKey:obj.propertyName];</div><div class="line">                &#125;else &#123;</div><div class="line">                    </div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;else if (Exist_(obj.propertyClass, @[[NSDictionary class],[NSMutableDictionary class]])) &#123;</div><div class="line">            NSDictionary *obj_dict = [jsonDict valueForKey:[_analysisDict objectForKey:obj.propertyName]];</div><div class="line">            if (!obj_dict) &#123;</div><div class="line">                [_object setValue:[NSNull null] forKey:obj.propertyName];</div><div class="line">            &#125;else &#123;</div><div class="line">                [_object setValue:obj_dict forKey:obj.propertyName];</div><div class="line">            &#125;</div><div class="line">        &#125;else if (obj.isBasicType)&#123;</div><div class="line">            //åŸºæœ¬ç±»å‹</div><div class="line">            id num = [jsonDict valueForKey:[_analysisDict objectForKey:obj.propertyName]];</div><div class="line">            if (!num || num == [NSNull null]) &#123;</div><div class="line">                //ä¸ºç©ºåˆ¤æ–­</div><div class="line">                //è¿™é‡Œæˆ‘ä»¬é»˜è®¤è®¾ç½®ä¸º 0.00å¤§å°çš„NSNumberå¯¹è±¡Â </div><div class="line">                [_object setValue:NULL_NUM forKey:obj.propertyName];</div><div class="line">            &#125;else &#123;</div><div class="line">                NSNumber *number = (NSNumber *)num;</div><div class="line">                [_object setValue:number forKey:obj.propertyName];</div><div class="line">            &#125;</div><div class="line">        &#125;else &#123;</div><div class="line">            Class OBJClass = obj.propertyClass;</div><div class="line">            if(!Exist_(OBJClass, foundationClasses_)) &#123;</div><div class="line">                //å¦‚æœç±»å‹ä¸ºè‡ªå®šä¹‰ç±»</div><div class="line">                id obj_dict = [jsonDict valueForKey:[_analysisDict objectForKey:obj.propertyName]];</div><div class="line">                //éç©ºåˆ¤æ–­</div><div class="line">                if (!obj_dict) &#123;</div><div class="line">                    id objx = [[OBJClass alloc] cm_initWithJSONString:DataToJSONString(obj_dict)];</div><div class="line">                    [_object setValue:objx forKey:obj.propertyName];</div><div class="line">                &#125;else &#123;</div><div class="line">                    //è¿™é‡Œå¯ä»¥èµ‹å€¼ä¸º[NSNull null] å¯ä»¥èµ‹å€¼ä¸ºä¸€ä¸ªæ–°å¯¹è±¡</div><div class="line">//                    [_object setValue:[NSNull null] forKey:obj.propertyName];</div><div class="line">                    [_object setValue:[[OBJClass alloc] init] forKey:obj.propertyName];</div><div class="line">                &#125;</div><div class="line">            &#125;else &#123;</div><div class="line">                [_object setValue:[jsonDict valueForKey:[_analysisDict objectForKey:obj.propertyName]] forKey:obj.propertyName];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="4-å¦‚ä½•ä½¿ç”¨"><a href="#4-å¦‚ä½•ä½¿ç”¨" class="headerlink" title="4. å¦‚ä½•ä½¿ç”¨"></a>4. å¦‚ä½•ä½¿ç”¨</h2><hr>
<p>ä¸¾ä¾‹è¯´æ˜ï¼š<br>è¿™é‡Œæœ‰ä¸‰ä¸ªç±»<br><strong>Animals(åŠ¨ç‰©)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@property (strong, nonatomic) NSArray &lt;Dog *&gt; *dogs;</div><div class="line">@property (strong, nonatomic) NSArray &lt;Pig *&gt; *pigs;</div></pre></td></tr></table></figure></p>
<p>â€”å®ç°æ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (NSDictionary *)dict_CMModelWithClass &#123;</div><div class="line">    return @&#123;</div><div class="line">             @&quot;dogs&quot; : @&quot;dog&quot;,</div><div class="line">             @&quot;pigs&quot; : @&quot;pig&quot;,</div><div class="line">             &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (NSDictionary *)dict_CMModelWIthArrayClass &#123;</div><div class="line">    return @&#123;</div><div class="line">             @&quot;dogs&quot; : @&quot;Dog&quot;,</div><div class="line">             @&quot;pigs&quot; : @&quot;Pig&quot;,</div><div class="line">             &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>Dog(ç‹—)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@property (strong, nonatomic) NSString *dog_name;</div><div class="line">@property (assign, nonatomic) NSUInteger dog_age;</div><div class="line"></div><div class="line">//ç‹—å…»çš„çŒª</div><div class="line">@property (strong, nonatomic) Pig *dog_pig;</div></pre></td></tr></table></figure></p>
<p>â€”å®ç°æ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (NSDictionary *)dict_CMModelWithClass &#123;</div><div class="line">    return @&#123;</div><div class="line">             @&quot;dog_age&quot; : @&quot;age&quot;,</div><div class="line">             @&quot;dog_name&quot; : @&quot;name&quot;,</div><div class="line">             @&quot;dog_pig&quot; : @&quot;dog_pig&quot;</div><div class="line">             &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>Pig(çŒª)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@property (strong, nonatomic) NSString *pig_name;</div><div class="line">@property (assign, nonatomic) NSUInteger pig_age;</div></pre></td></tr></table></figure></p>
<p>â€”å®ç°æ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (NSDictionary *)dict_CMModelWithClass &#123;</div><div class="line">    return @&#123;</div><div class="line">             @&quot;pig_age&quot; : @&quot;age&quot;,</div><div class="line">             @&quot;pig_name&quot; : @&quot;name&quot;</div><div class="line">             &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>è°ƒç”¨æ–¹æ³•</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NSString *testJSON = @&quot;&#123;\&quot;dog\&quot;:[&#123;\&quot;name\&quot;:\&quot;dog_1\&quot;,\&quot;age\&quot;:15,\&quot;dog_pig\&quot;:&#123;\&quot;name\&quot;:\&quot;dogAndPig1\&quot;,\&quot;age\&quot;:666&#125;&#125;,&#123;\&quot;name\&quot;:\&quot;dog_2\&quot;,\&quot;age\&quot;:null,\&quot;dog_pig\&quot;:null&#125;],\&quot;pig\&quot;:[&#123;\&quot;name\&quot;:\&quot;pig_1\&quot;,\&quot;age\&quot;:10&#125;,&#123;\&quot;name\&quot;:\&quot;pig_2\&quot;,\&quot;age\&quot;:12&#125;]&#125;&quot;;</div><div class="line"></div><div class="line">Animals *animals = [[Animals alloc] cm_initWithJSONString:testJSON];</div></pre></td></tr></table></figure></p>
<p>#å†™åœ¨åé¢çš„è¯<br>è¿™ä¸ªé¡¹ç›®å¹¶ä¸å®Œå–„ï¼Œæ¯”å¦‚è¯´å¯¹äºå…¶ä¸­æ—¥æœŸçš„æ ¼å¼åŒ–ï¼Œéç©ºçš„ä¸€äº›åˆ¤æ–­ç­‰ï¼Œå…¶ä¸­ä¹Ÿæœ‰ä¸€äº›bugï¼Œæœ¬æ–‡æƒå½“æ˜¯æŠ›ç –å¼•ç‰ï¼Œåˆ©ç”¨<code>Runtime</code>å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚ä½ å¯ä»¥å®ç°ï¼Œä¸€å¥è¯å®Œæˆå½’æ¡£ä¸è§£å½’æ¡£ï¼Œä¸ä¼šå†å‡ºç°Modelå±æ€§è¿‡å¤šæ—¶é‡å†™<code>initWithCoder</code>å’Œ<code>encodeWithCoder</code>çš„å°´å°¬äº†ï¼Œsoï¼Œæœ‰æ—¶å€™æˆ‘ä»¬æ›´ç¼ºçš„æ˜¯ä¸€ç§æ€è€ƒé—®é¢˜çš„æ–¹å¼ï¼Œå…±å‹‰ï¼</p>
<p>PSï¼šæ¬¢è¿æ¥æˆ‘çš„ç®€ä¹¦ã€Githubã€ä¸ªäººåšå®¢äº¤æµğŸ˜„</p>
<blockquote>
<p><a href="https://github.com/jiachenmu/JSONTOModel" target="_blank" rel="external">æ–‡ä¸­çš„Demoä¸‹è½½åœ°å€</a></p>
</blockquote>

          </section>
        </article>
        

       
        <div class="pager">
          
          
            <a class="post-next pager-item" href="/2016/07/04/iOS-Reactive-Cocoaä½¿ç”¨æµ…æ/">
              <strong class="article-nav-caption">Ouder</strong>
              <p class="post-nav-title">iOS Reactive Cocoaä½¿ç”¨æµ…æ</p>
            </a>
          
        </div>
        

         <!-- comments -->
        <div class="comment-section">
  
    

    <!-- å¤šè¯´è¯„è®ºæ¡† start -->
      <div class="ds-thread" data-thread-key="_posts/iOSåˆ©ç”¨Runtimeå†™ä¸€ä¸ªJsonè½¬Modelçš„å·¥å…·.md" data-title="iOSåˆ©ç”¨Runtimeå†™ä¸€ä¸ªJsonè½¬Modelçš„å·¥å…·" data-url="http://yoursite.com/2016/07/19/iOSåˆ©ç”¨Runtimeå†™ä¸€ä¸ªJsonè½¬Modelçš„å·¥å…·/"></div>
    <!-- å¤šè¯´è¯„è®ºæ¡† end -->
    <!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
      <script type="text/javascript">
      var duoshuoQuery = {short_name:"wayouliu"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- å¤šè¯´å…¬å…±JSä»£ç  end -->

  


</div>

    </div>
    
</div>

                </div>
            </div>
        </div>
        <footer class="footer">
    <p>ç”±<a href="http://hexo.io/" target="_blank">Hexo</a>å¼ºåŠ›é©±åŠ¨ï¼Œæ­è½½<a href="https://github.com/wayou/hexo-theme-gstyle">gstyle</a>ä¸»é¢˜</p>
    <p>
        &copy; 2016 ManoBoo
    </p>
</footer>
<script src="/lib/jquery.js"></script>
<script src="/lib/waves.js"></script>
<script src="/lib/jquery-ui.js"></script>
<script src="/lib/jquery.tocify.js"></script>
<script src="/js/main.js"></script>

    </body>
</html>
