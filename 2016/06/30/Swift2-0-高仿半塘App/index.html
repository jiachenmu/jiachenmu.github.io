<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  
  <title>Swift2.0 é«˜ä»¿åŠå¡˜App</title>
  <meta name="author" content="ManoBoo">
   <meta name="description" content="ManoBooçš„æŠ€æœ¯åšå®¢ï¼Œä»¥åæ–‡ç« ä¼šå’Œç®€ä¹¦åŒæ­¥æ›´æ–°~">
  

  <meta property="og:title" content="Swift2.0 é«˜ä»¿åŠå¡˜App"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="ManoBooçš„æŠ€æœ¯å°çª"/>
 <meta property="og:image" content="undefined"/>
  
  <link rel="alternate" href="/atom.xml" title="ManoBooçš„æŠ€æœ¯å°çª" type="application/atom+xml">
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>
  <div id="main">
    <div class="behind">
      <div class="back">
        <a href="/" class="black-color"><i class="fa fa-times" aria-hidden="true"></i></a>
      </div>
      <div class="description">
        &nbsp;æ¬¢è¿æ¥ManoBooçš„å°çªåšå®¢
      </div>
    </div>
    <div class="container">
      

  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        Swift2.0 é«˜ä»¿åŠå¡˜App
    </h1>
  


    </div>
    <div class="meta center">
      
<time datetime="2016-06-30T01:27:39.000Z">
  <i class="fa fa-calendar"></i>&nbsp;
  2016-06-30
</time>






    
    &nbsp;
    <i class="fa fa-tag"></i>&nbsp;
    <a href="/tags/Swift2-0-é«˜ä»¿App-åŠå¡˜/">Swift2.0 é«˜ä»¿App åŠå¡˜</a>


    </div>
    <hr>
    <div class="picture-container">
      
    </div>
    <p>#IOS-Swift2.0 é«˜ä»¿åŠç³–App</p>
<hr>
<p>##å†™åœ¨å‰é¢çš„è¯<br>â€“å°‘å¹´æˆ‘æ˜¯å»å¹´æ¯•ä¸šåšIOSå¼€å‘çš„ï¼Œè¿™ä¸ªé¡¹ç›®å¤§æ¦‚æ˜¯2016å¹´1æœˆä»½åˆ°ç°åœ¨åšå®Œçš„ï¼Œé¡¹ç›®åˆšå¼€å§‹æ²¡å­¦è¿‡Swiftè¯­è¨€ï¼Œä½†æƒ³ç€ä¸ä¼šå°±è¯¥å»æŒ‘æˆ˜ï¼Œäºæ˜¯è¾¹å­¦ä¹ è¾¹åšè¿™ä¸ªé¡¹ç›®ï¼Œç°åœ¨å¯¹Swiftä¹Ÿæœ‰äº†ä¸€å®šçš„äº†è§£<br>ï¼Œåœ¨æ­¤æ„Ÿè°¢<a href="http://www.jianshu.com/users/5fe7513c7a57/latest_articles" target="_blank" rel="external">ç»´å°¼çš„å°ç†Š</a>çš„æŒ‡å¯¼</p>
<p>##å…³äºé¡¹ç›®(GitHubåœ°å€åœ¨æ–‡ç« æœ€ä¸‹æ–¹)<br>â€“è¿™ä¸ªå¼€æºé¡¹ç›®ä¸ºåŠç³–ï¼Œ<a href="http://www.ibantang.com" target="_blank" rel="external">å®˜ç½‘â¡</a>,ç±»ä¼¼äºç¾ä¸½è¯´ï¼Œä¸€æ¬¾ç”µå•†Appï¼Œä½¿ç”¨è¯­è¨€:Swift2.0,å¼€å‘å·¥å…·: Xcode 7.1,çº¯ä»£ç å¼€å‘,è€—æ—¶ä¸¤ä¸ªå¤šæœˆï¼Œæ•°æ®ä¸ºæœ¬åœ°æ•°æ®ï¼Œç”¨Charlesè¿›è¡ŒæŠ“åŒ…ã€‚<br>â€“é¡¹ç›®æµ‹è¯•æœºä¸º5Sï¼ŒUIæ²¡æœ‰å¯¹6/6Sè¿›è¡Œé€‚é…<br>â€“å› ä¸ºå¼€å‘æ—¶é—´æœ‰é™ï¼ŒAPPé‡Œé¢çš„å„ç§åˆ†ç±»ç›¸å½“ç¹å¤šï¼Œå› æ­¤é¦–é¡µä¸­æµ‹è¯•çš„è¯ç‚¹ç¬¬ä¸€ä¸ªåˆ†ç±»ï¼Œç¬¬ä¸€ä¸ªcellï¼Œä¸€èˆ¬éƒ½æ˜¯æœ‰æ•°æ®çš„ï¼Œæ²¡æœ‰ä¹Ÿä¼šæç¤ºã€‚<br>â€“æˆ‘æ˜¯ä¸ªæ–°æ‰‹,Bugæ˜¯éš¾å…çš„å˜›ã€‚å¦‚æœå‘ç°æœ‰Bugå’Œç–‘é—®ï¼Œè¯·å‘æˆ‘è”ç³»ï¼ŒQQã€ç®€ä¹¦ã€å¾®åšéƒ½å¯ä»¥<br>â€“Tips:é¦–é¡µæ”¯æŒ3D Touchï¼Œå¯ä»¥è¯•è¯•å“¦~</p>
<p>##é¡¹ç›®æ•ˆæœå›¾</p>
<p>####é¦–é¡µå±•ç¤º<br><img src="http://upload-images.jianshu.io/upload_images/1299512-f59c8f1a63af8958.gif?imageMogr2/auto-orient/strip" alt="é¦–é¡µè½®æ’­å›¾åŠ å±•ç¤º.gif"></p>
<p>#####é¦–é¡µ-æ¸…å•å±•ç¤º</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-bafce461cd2e285b.gif?imageMogr2/auto-orient/strip" alt="é¦–é¡µ-æ¸…å•å±•ç¤º.gif"></p>
<p>#####é¦–é¡µ-æœç´¢åˆ†ç±»å±•ç¤º</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-0d90d236d859233e.gif?imageMogr2/auto-orient/strip" alt="é¦–é¡µ-æœç´¢å±•ç¤º.gif"></p>
<p>####3D Touchå±•ç¤º(ç”¨6SåŠ6Sä»¥ä¸Šæµ‹è¯•)</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-3c0e3ba29e9f00d8.gif?imageMogr2/auto-orient/strip" alt="3DTouchå±•ç¤º.gif"></p>
<p>####å¹¿åœºå±•ç¤º<br><img src="http://upload-images.jianshu.io/upload_images/1299512-033b26149abfad1d.gif?imageMogr2/auto-orient/strip" alt="é¦–é¡µ-å¹¿åœºå±•ç¤º.gif"></p>
<p>####ç§€</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-626bdc9943daf60d.gif?imageMogr2/auto-orient/strip" alt="ç§€æˆ‘å±•ç¤º.gif"></p>
<p>####æ¶ˆæ¯(è¿™ä¸€éƒ¨åˆ†ğŸ˜‚ï¼Œæˆ‘æ²¡å¥½å‹ï¼Œæ²¡ç²‰ä¸ï¼ŒæŠ“åŒ…æœ¨æœ‰æ•°æ®ï¼Œæ‰€ä»¥å°±æŒ‰ç…§è‡ªå·±çš„æƒ³æ³•åšå’¯)</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-6dca6a94de88f6ff.gif?imageMogr2/auto-orient/strip" alt="æ¶ˆæ¯.gif"></p>
<p>####ä¸ªäººä¸­å¿ƒ(æ¢å¤´åƒè¯·ç”¨çœŸæœºæµ‹è¯•~)</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-1295962d038abd25.gif?imageMogr2/auto-orient/strip" alt="ä¸ªäººä¸­å¿ƒ.gif"></p>
<p>##é¡¹ç›®è¯¦ç»†è®²è§£ (æŒ‰APPçš„å¯åŠ¨é¡ºåºæ¥)</p>
<p>####å¯åŠ¨é¡µé¢</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-5510cff43f75da01.gif?imageMogr2/auto-orient/strip" alt="å¯åŠ¨é¡µé¢.gif"><br>ä¸»è¦ä»£ç å¦‚ä¸‹:<br>1.åœ¨appDelegateä¸­<br><code>self.window?.rootViewController = mainViewController()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">//MARK: Appé¦–æ¬¡å¯åŠ¨æ˜¾ç¤º appçš„ç®€ä»‹</div><div class="line">    func mainViewController() -&gt; UIViewController&#123;</div><div class="line">        //firstStartä¸ä¸ºç©º,ä¸æ˜¯æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨</div><div class="line">        if  NSUserDefaults.standardUserDefaults().objectForKey(&quot;FirstStart&quot;) != nil &#123;</div><div class="line">            return self.tabbarController</div><div class="line">        &#125;else &#123;</div><div class="line">            //æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨</div><div class="line">            NSUserDefaults.standardUserDefaults().setObject(false, forKey: &quot;FirstStart&quot;)</div><div class="line">            let firstVC = FirstStartViewController()</div><div class="line"></div><div class="line">            return firstVC</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>Tips: ç”¨æˆ·ç¬¬ä¸€æ¬¡å¯åŠ¨Appçš„æ—¶å€™<code>self.window.rootViewController = FirstStartViewController()</code>  ä½¿ç”¨æˆ·è¿›å…¥å¼•å¯¼é¡µï¼ŒåŠ¨ç”»å®Œæˆåï¼Œç‚¹å‡»ã€å¼€å¯Appä¹‹æ—…ã€,å¼•å¯¼é¡µå‘å‡º é€šçŸ¥ï¼ŒappDelegateæ¥å—é€šçŸ¥ï¼Œå†å°†<code>self.window?.rootViewController = self.tabBarController</code></p>
<p>####é¦–é¡µ-å±•ç¤º</p>
<p>#####â‘ æœ€å¥½çš„è®¾è®¡æ€è·¯åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-84bab42ca5fbfa65.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp4c68a801.png"><br>Tipsï¼šä»¥ä¸‹çš„æ€è·¯ åœ¨ä¸ªäººä¸­å¿ƒå¾ˆå®Œæ•´ï¼Œå‰å»çœ‹çœ‹å“ˆ</p>
<p>######1.çº¢è‰²éƒ¨åˆ†è®¾è®¡ä¸º collectionHeaderView<br>æ–¹æ³•ï¼š åˆå§‹åŒ–collecitonViewæ—¶  åœ¨å…¶layoutå‚æ•°ä¸­è®¾ç½®<br><code>layout.headerReferenceSize = CGSizeMake(width, height)</code><br>ç„¶åcollectionView æ³¨å†Œè¿™ä¸ªheaderView<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public func registerClass(viewClass: AnyClass?, forSupplementaryViewOfKind elementKind: String, withReuseIdentifier identifier: String)`</div><div class="line">ç„¶å åœ¨collectionViewä»£ç†æ–¹æ³•</div><div class="line">`func collectionView(collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, atIndexPath indexPath: NSIndexPath) -&gt; UICollectionReusableView &#123;</div><div class="line">        var reuseView = UICollectionReusableView()</div><div class="line">        if kind == UICollectionElementKindSectionHeader &#123;</div><div class="line">            let headView = collectionView.dequeueReusableSupplementaryViewOfKind(UICollectionElementKindSectionHeader, withReuseIdentifier: &quot;collectionViewHeaderView&quot;, forIndexPath: indexPath)</div><div class="line">            </div><div class="line">            headView.addSubview(collectionHeadView)</div><div class="line">            reuseView = headView</div><div class="line">        &#125;</div><div class="line">        return reuseView</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>######2.ç»¿è‰²éƒ¨åˆ†ä¸ºcollectionView åªä½œä¸ºå®¹å™¨ä½¿ç”¨</p>
<p>######3.è“è‰²éƒ¨åˆ†ä¸ºæ˜¾ç¤ºçš„tableviewï¼Œæ·»åŠ åˆ°collectionViewçš„cell.contentViewè¿›è¡Œæ˜¾ç¤º<br>Tips:ç°åœ¨å¾ˆå¤šAppçš„å¯åŠ¨é¡µé¢ä¹Ÿæ˜¯è¿™ä¸ªæ€è·¯ï¼Œæ•´ä½“ä¸ºä¸€ä¸ªUICollectionViewï¼Œæ¯ä¸€ä¸ªcelléƒ½æ·»åŠ UITableViewè¿›è¡Œæ˜¾ç¤º</p>
<p>#####â‘¡å…³äºcell åŠ¨æ€é«˜åº¦çš„é—®é¢˜,ä¸Šå›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-4f95d6d29d3a0ec3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp3734bf84.png"><br>è“è‰²çš„è¿™ä¸€éƒ¨åˆ†æ˜¯æ¸…å•è¯¦æƒ…ä¸­çš„æè¿°å†…å®¹ï¼ŒJSONä¸­çš„æè¿°æ–‡å­—éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¯¼è‡´æ•´ä¸ªcellçš„é«˜åº¦éƒ½æ˜¯åŠ¨æ€ä¸å®šçš„<br>Tipsï¼š<br>1.åœ¨cellæ‰€æœ‰çš„modelä¸­æ·»åŠ <code>cellHeight</code>å­—æ®µ,åœ¨tableViewä»£ç†æ–¹æ³•<code>heightForRowAtIndexPath</code>ä¸­,åˆ¤æ–­modelä¸­çš„<code>cellHeight</code>å­—æ®µæ˜¯ä¸æ˜¯ä¸ºç©ºï¼Œæœ‰å€¼åˆ™è¿”å›è¯¥å€¼,ç±»ä¼¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">func tableView(tableView: UITableView, heightForRowAtIndexPath indexPath: NSIndexPath) -&gt; CGFloat &#123;</div><div class="line">       //modelä¸ºå¯¹åº”cellçš„model</div><div class="line">      if model.cellHeight != nil &#123;</div><div class="line">             return model.cellHeight</div><div class="line">       &#125;</div><div class="line">    return 30</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2.cellä¸­çš„å±æ€§model é‡å†™setæ–¹æ³•ï¼Œç±»ä¼¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var model: YourModel&#123;</div><div class="line">  didSet&#123;</div><div class="line">        //--------</div><div class="line">            åšä½ çš„æ“ä½œ</div><div class="line">        //-------</div><div class="line">        if model.cellHeight == nil &#123;</div><div class="line">        model.cellHeight = ä½ è®¡ç®—åçš„é«˜åº¦</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>#####â‘¢ 3D Touch<br>Tips:å…¶å®Appä¸­åº”ç”¨æœ€å¤šçš„ä¹Ÿå°±æ˜¯ä¸ç”¨ç‚¹è¿›å»çœ‹ã€‚å¯ä»¥é¢„è§ˆä¸‹ä¸€çº§æ˜¾ç¤ºçš„å†…å®¹ï¼Œæ¯”å¦‚ å¾®ä¿¡</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-a13038df731a2086.gif?imageMogr2/auto-orient/strip" alt="3D Touché€šç”¨.gif"><br>ä¸Šä»£ç ï¼š<br><code>viewDidLoad()</code>ä¸­ <code>self.add3DTouch()</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">//MARK: æ·»åŠ  3D touchåŠŸèƒ½</div><div class="line">    func add3DTouch() &#123;</div><div class="line">        //1.æ£€æµ‹ 3D touch æ˜¯å¦å¯ç”¨</div><div class="line">        if traitCollection.forceTouchCapability == .Available &#123;</div><div class="line">            //3DTouchå¯ç”¨ï¼Œ</div><div class="line">            registerForPreviewingWithDelegate(self, sourceView: view)</div><div class="line">        &#125;else &#123;</div><div class="line">            //ä¸å¯ç”¨</div><div class="line">            TipView.showMessage(&quot;ä¸æ”¯æŒ3Dtouch,æ¢ä¸ª6Så§,ä¸è°¢ğŸ˜‚&quot;)    </div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>Tipsï¼š<br>1 <code>registerForPreviewingWithDelegate(delegate: UIViewControllerPreviewingDelegate, sourceView: UIView)</code>æ–¹æ³•ä¸­delegateå³ä¸ºå½“å‰æ§åˆ¶å™¨selfï¼Œ<code>sourceView</code>å³ä¸ºæ„Ÿåº”3DTouchåŠŸèƒ½çš„Viewï¼Œå½“å‰æ§åˆ¶å™¨ä¸­ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯<code>self.view</code><br>2.æ§åˆ¶å™¨ä¸Šæ·»åŠ ä»£ç†<code>UIViewControllerPreviewingDelegate</code>,å®ç°æ–¹<code>func previewingContext(previewingContext: UIViewControllerPreviewing, viewControllerForLocation location: CGPoint) -&gt; UIViewController?</code>å’Œ<code>func previewingContext(previewingContext: UIViewControllerPreviewing, commitViewController viewControllerToCommit: UIViewController)</code>,<br>çœ‹ä»£ç :</p>
<p>â‘ è¿™ä¸€éƒ¨åˆ†å…¶å®å°±ä¸¤ä¸ªæ­¥éª¤</p>
<ul>
<li>1.ç»™3D Touch ä½ è¦é¢„è§ˆçš„ViewController</li>
<li>2.è®¾å®š3D Touché¢„è§ˆæ§åˆ¶å™¨çš„å°ºå¯¸å¤§å°</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">func previewingContext(previewingContext: UIViewControllerPreviewing, viewControllerForLocation location: CGPoint) -&gt; UIViewController? &#123;</div><div class="line">        </div><div class="line">        </div><div class="line">        //-----è¿™ä¸€è¿‡ç¨‹è¿™ä¹ˆç¹ç  è¯´ç™½äº†å°±æ˜¯æ‰¾åˆ°å½“å‰æ‰‹æŒ‡ç‚¹åˆ°çš„ tableviewCellï¼Œåé¢ 3Dtouch é¢„è§ˆçš„æ—¶å€™ä¼šç”¨åˆ° åŸå°ºå¯¸ cell.frame</div><div class="line">        let index = Int( showCollectionView.contentOffset.x / SCREEN_WIDTH )</div><div class="line">        let collectionViewCell = showCollectionView.cellForItemAtIndexPath(NSIndexPath(forRow: 0, inSection: index))</div><div class="line">        var tableView = UITableView()</div><div class="line">        for aview in collectionViewCell!.contentView.subviews &#123;</div><div class="line">            if aview.isKindOfClass(UITableView.self) &#123;</div><div class="line">                tableView = aview as! UITableView</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        //*******</div><div class="line">        </div><div class="line">        let indexPath = tableView.indexPathForRowAtPoint(location)</div><div class="line">        let cell = tableView.cellForRowAtIndexPath(indexPath!) as! HomeCell</div><div class="line">        </div><div class="line">        let detailListContrller = ListDetailViewController(listId: &quot;1872&quot;,transImage: cell.imgView.image!)</div><div class="line">        </div><div class="line">    </div><div class="line">        //é¢„æ˜¾ç¤ºçš„å°ºå¯¸</div><div class="line">        detailListContrller.preferredContentSize = CGSizeMake(SCREEN_WIDTH, 600)</div><div class="line">        //æºå°ºå¯¸</div><div class="line">        previewingContext.sourceRect = cell.frame</div><div class="line">        </div><div class="line">        return detailListContrller</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>â‘¡å¯¹å³å°†é¢„è§ˆçš„ViewControllerï¼Œåšä¸€äº›æ“ä½œï¼Œæ¯”å¦‚<strong>éšè—tabbarï¼Œéšè—å¯¼èˆªæ </strong>ç­‰ç­‰ï¼Œç„¶åæ˜¾ç¤ºå‡ºæ¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">func previewingContext(previewingContext: UIViewControllerPreviewing, commitViewController viewControllerToCommit: UIViewController) &#123;</div><div class="line">        showViewController(viewControllerToCommit, sender: self)</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>####å¹¿åœº-å±•ç¤º<br>è®¾è®¡æ€è·¯å¦‚å›¾:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-32d54cd4642191bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp4c3452b2.png"></p>
<p>######ä¸é¦–é¡µç›¸ä¼¼ï¼Œçº¢è‰²éƒ¨åˆ†Viewæ˜¯è“è‰² mainCollectionViewçš„headerViewï¼Œçº¢è‰²Viewä¸­åˆåŒ…å«ç€ä¸€ä¸ªcollectionView</p>
<p>######ä¸‹æ‹‰åˆ·æ–°æ§ä»¶ï¼š </p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-99ce105df96fba14.gif?imageMogr2/auto-orient/strip" alt="ä¸‹æ‹‰åˆ·æ–°æ§ä»¶.gif"><br>Tips:ä¸‹æ‹‰åˆ·æ–°æ§ä»¶ ä½¿ç”¨SVPullToRefresh æ¡†æ¶ï¼Œç„¶ååœ¨å®ƒçš„æ–‡ä»¶ä¸­ä¿®æ”¹äº†ä¸€ä¸ªæ–¹æ³•ï¼ŒæŠŠè‡ªå·±æƒ³è¦å‡ºç°çš„åŠ¨å›¾åŠ äº†è¿›å»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">- (SVPullToRefreshArrow *)arrow &#123;</div><div class="line">    if(!_arrow) &#123;</div><div class="line">		_arrow = [[SVPullToRefreshArrow alloc]initWithFrame:CGRectMake(0, self.bounds.size.height-54, 22, 48)];</div><div class="line">        _arrow.backgroundColor = [UIColor clearColor];</div><div class="line">              //å°†æ¡†æ¶è‡ªå¸¦çš„åˆ·æ–°ç®­å¤´å±è”½æ‰</div><div class="line">//		[self addSubview:_arrow];</div><div class="line">        </div><div class="line">        //è¿™ä¸€éƒ¨åˆ†æ˜¯æˆ‘è‡ªå®šä¹‰æ˜¾ç¤ºçš„View</div><div class="line">        UIImageView *gifImgView = [[UIImageView alloc] initWithFrame:CGRectMake(0, self.bounds.size.height-54, 125, 125)];</div><div class="line">        self.clipsToBounds = YES;</div><div class="line">        gifImgView.backgroundColor = [UIColor whiteColor];</div><div class="line">        gifImgView.image = [UIImage sd_animatedGIFNamed:@&quot;refreshGif&quot;];</div><div class="line">        //è®¾ç½®åˆ·æ–°åŠ¨å›¾åªåœ¨LoadingçŠ¶æ€ä¸‹æ˜¾ç¤º</div><div class="line">        [self setCustomView:gifImgView forState:SVPullToRefreshStateLoading];</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return _arrow;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>####ç§€å‡ºè‡ªæˆ‘<br>è¿™ä¸€éƒ¨åˆ†çš„å®ç°æ€è·¯æ¯”è¾ƒç®€å•<br>1.åœ¨appdelegateä¸­ï¼Œå®ç°tabbarControllerDelegateæ–¹æ³•,<code>shouldSelectViewController</code>ä¸­ï¼Œåˆ¤æ–­æ¯æ¬¡ç‚¹å‡»çš„æ˜¯ä¸æ˜¯ShowMeController,å¦‚æœæ˜¯,åˆ™è¿”å›falseï¼Œç„¶ååœ¨å½“å‰çš„æ§åˆ¶å™¨<code>viewController.presentViewController(ShowMeViewController, animated: true, completion: nil)</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">func tabBarController(tabBarController: UITabBarController, shouldSelectViewController viewController: UIViewController) -&gt; Bool &#123;</div><div class="line">        </div><div class="line">        </div><div class="line">        let childArray = tabbarController.childViewControllers</div><div class="line">        let index = childArray.indexOf(viewController)</div><div class="line">        if index == 2 &#123;</div><div class="line">            print(&quot;Show me!&quot;)</div><div class="line">            presentShowMeViewController(viewController)</div><div class="line">            return false</div><div class="line">        &#125;else if index == 3 &#123;</div><div class="line">            //ç‚¹å‡» &apos;æ¶ˆæ¯ä¸­å¿ƒ&apos; å»¶è¿Ÿ5s åå‘å‡ºé€šçŸ¥</div><div class="line">            //æ¨¡æ‹Ÿç½‘ç»œåˆ·æ–°</div><div class="line">            viewController.tabBarItem.title = nil</div><div class="line">            postNotificationCenter(tabbarController.viewControllers!)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        return true</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>2.å¯¹äºè°ƒç”¨ç…§ç›¸æœºçš„æ–¹æ³•ï¼Œé¦–å…ˆåˆ¤æ–­æœ‰æ²¡æœ‰æ‘„åƒå¤´<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">if UIImagePickerController.isSourceTypeAvailable(UIImagePickerControllerSourceType.Camera) &#123;</div><div class="line">            imagePicker.sourceType = UIImagePickerControllerSourceType.Camera</div><div class="line">            presentViewController(imagePicker, animated: true, completion: nil)</div><div class="line">        &#125;else &#123;</div><div class="line">            TipView.showMessage(&quot;éªšå¹´ï¼Œæ‰¾ä¸ªæœ‰æ‘„åƒå¤´çš„æ‰‹æœºå§ã€‚ã€‚&quot;)</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<p>ç„¶åviewControllerä¸­æ·»åŠ ä»£ç† <code>UIImagePickerControllerDelegate,UINavigationControllerDelegate</code><br>åœ¨ä»£ç†æ–¹æ³•ä¸­å¯ä»¥è·å–åˆ°åˆšæ‹å¥½çš„å›¾ç‰‡è¿›è¡Œå¤„ç†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">func imagePickerController(picker: UIImagePickerController, didFinishPickingImage image: UIImage, editingInfo: [String : AnyObject]?) &#123;</div><div class="line">        dispatch_async(dispatch_get_main_queue()) &#123; () -&gt; Void in</div><div class="line">            picker.dismissViewControllerAnimated(true, completion: nil)</div><div class="line">            self.topView.headerImage = image</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>####æ¶ˆæ¯è¿™ä¸€éƒ¨åˆ†å°±å¾ˆå°‘ä¸œè¥¿äº†ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰ç²‰ä¸ï¼Œæ²¡æœ‰æ¶ˆæ¯ğŸ˜‚ï¼Œ<br>ä¸ºäº†æ¨¡æ‹Ÿåå°å‘é€æ¶ˆæ¯ï¼Œåœ¨tabBarControllerçš„â€shouldSelectViewControllerâ€ä¸­ï¼Œå½“ç‚¹å‡»è¯¥æ§åˆ¶å™¨æ—¶ï¼Œappdelegateå‘å‡ºé€šçŸ¥ï¼ŒMessageViewControllerä¸­æ¥æ”¶é€šçŸ¥ï¼Œæç¤ºç”¨æˆ·æ”¶åˆ°æ¶ˆæ¯<br><code>//æ¥å— æ¨¡æ‹Ÿåå°çš„æ¨é€ã€ã€ã€ã€
        NSNotificationCenter.defaultCenter().addObserver(self, selector: &quot;hasNewMessage&quot;, name: UserHasNewMessage, object: nil)</code></p>
<p>æ”¶åˆ°é€šçŸ¥ä»¥åæ‰§è¡Œçš„æ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">func hasNewMessage()&#123;</div><div class="line">        print(&quot;æ”¶åˆ°é€šçŸ¥äº†ã€‚&quot;)</div><div class="line">        TipView.showMessage(&quot;æ‚¨æœ‰æ–°çš„æ¶ˆæ¯ã€‚ä½†æ˜¯ä½ çœ‹ä¸è§ğŸ˜œ&quot;)</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>####ä¸ªäººä¸­å¿ƒ<br>è¿™ä¸€éƒ¨åˆ†è®¾è®¡æ€è·¯ä¸å¹¿åœºç±»ä¼¼ï¼Œä¹Ÿéƒ½æ˜¯ä¸Šé¢æ˜¯HeaderViewï¼Œä¸‹é¢æ˜¯UICollectionView,ä¸åŒçš„æ˜¯ä¸ªäººä¸­å¿ƒæœ€ä¸Šé¢æœ‰ä¸€ä¸ªèƒŒæ™¯å›¾ç‰‡ï¼Œä¼šéšç€collectionViewçš„contentOffSetå˜åŒ–è€Œæ”¾å¤§<br>è®¾è®¡æ€è·¯ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/1299512-c373856c19d81113.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp2ae3bf03.png"></p>
<p>1.é»„è‰²Viewä¸º UIImageViewï¼Œå¤„äºæ•´ä¸ªViewçš„ä¸‹å±‚ï¼ŒcollectionViewå’Œå®ƒçš„headerViewçš„<code>backgroundColor = UIColor.clearColor()</code><br>æœ€ååœ¨<code>func scrollViewDidScroll(scrollView: UIScrollView)</code>ä¸­è°ƒæ•´ backImageViewçš„<code>transform</code>å±æ€§å³å¯<br>2.å…³äºåœé é—®é¢˜ï¼Œ<br><img src="http://upload-images.jianshu.io/upload_images/1299512-5d605f459c2474c4.gif?imageMogr2/auto-orient/strip" alt="åœé é—®é¢˜.gif"><br>ä¸Šå›¾<br><img src="http://upload-images.jianshu.io/upload_images/1299512-baff52f142491aee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp19a4b2b9.png"><br>,å§‘ä¸”å«å®ƒ<code>titleView</code>, titleViewæ»šåˆ°è®¾å®šä½ç½®æ—¶ä¼šåœé åˆ°å¯¼èˆªæ åº•ä¸‹ï¼Œæ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>titleViewæ˜¯æ·»åŠ åˆ°headerViewä¸­çš„ï¼Œåœ¨<code>scrollViewDidScroll</code>æ–¹æ³•ä¸­ï¼Œç›‘å¬collectionViewçš„<code>contentOffset.y</code>çš„å˜åŒ–ï¼Œå½“titleViewåˆ°è¾¾è®¾å®šçš„ä½ç½®æ—¶ï¼Œ<code>titleView.removeFromSuperview()</code>,ç„¶åè®¡ç®—frameï¼Œå°†å…¶æ·»åŠ åˆ°Viewä¸Šï¼Œè¿™æ ·å°±åšé™¤äº†åœé çš„æ•ˆæœï¼Œè¿™æ ·åšæ¯”è¾ƒç®€å•<br>ğŸ˜¥:  åˆšå¼€å§‹æˆ‘å•ç‹¬å°†titleViewæ·»åŠ åˆ°viewä¸Šï¼ŒcollectionViewæ»‘åŠ¨æ—¶è¿˜å¾—ä¸€ç›´æ›´æ”¹<code>titleView.frame</code></li>
</ol>
<p>##èŠèŠæ„Ÿæƒ³å“ˆ<br>å…¶å®ä»OCè½¬å‘Swiftéå¸¸ç®€å•ï¼Œè¿™ä¸ªé¡¹ç›®ä¸éš¾ï¼Œå¾ˆé€‚åˆä»OCè½¬å‘swiftï¼Œæˆ–swiftåˆå­¦è€…ã€‚<br>å°‘å¹´ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å‘å¸ƒè‡ªå·±çš„é¡¹ç›®ï¼Œå¿˜è€é¸Ÿè½»æ‹ï¼Œæ–°æ‰‹å…±å‹‰,æœ‰ä»€ä¹ˆé—®é¢˜æˆ–bugè”ç³»æˆ‘å“ˆï¼Œæ¬¢è¿æ¥<a href="https://github.com/jiachenmu/Swift-BanTang" target="_blank" rel="external">æˆ‘çš„GitHub</a>ä¸Šèµä¸ªStarğŸŒŸ</p>
<p>##GitHub ä»£ç ä¸‹è½½åœ°å€<br><a href="https://github.com/jiachenmu/Swift-BanTang.git" target="_blank" rel="external">ä»£ç ä¸‹è½½åœ°å€,ç»™ä¸ªstarå†èµ°ğŸ™</a><br><strong>ç›´æ¥æ‰“å¼€è¿è¡Œå·¥ç¨‹</strong><br>ï¿¼<img src="http://upload-images.jianshu.io/upload_images/1299512-d0b3d3c1fcd7ed7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp1cbb03b9.png"></p>
<p>##æ”¶åˆ°æœ‰ç«¥é‹ååº”è¯´ï¼Œä¼šé‡åˆ°è¿™æ ·çš„Bugå¯¼è‡´æ— æ³•è¿è¡Œ<br><img src="http://upload-images.jianshu.io/upload_images/1299512-767663cc96358060.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp788532b0.png"></p>
<p>Tipsï¼šç”±äºGitHubä¸Šä¼ çš„é—®é¢˜ï¼Œè§£å†³åŠæ³•å¦‚ä¸‹ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1299512-ff192623db0d0fd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tmp44a0f1ff.png"></p>
<p>###é¡¹ç›®ç¼–å†™ä¸­ç”¨çš„åˆ‡å›¾ã€æ ‡æ³¨ã€åŠæœ¬åœ°æ•°æ®åœ¨æˆ‘çš„ç™¾åº¦äº‘</p>
<p><a href="http://pan.baidu.com/s/1dDZYetV" target="_blank" rel="external">åˆ‡å›¾ã€æ•°æ®ä¸‹è½½åœ°å€-ManoBppçš„ç™¾åº¦äº‘</a></p>


  </article>
  </script>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <div class="busuanzi center">
    é¡µé˜…è¯»é‡:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;ãƒ»&nbsp;
    ç«™è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;ãƒ»&nbsp;
    ç«™è®¿å®¢æ•°:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>




    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot container">
    <div class="firstrow">
        <a href="#top" >
        <i class="fa fa-arrow-right"></i>
        </a>
        Â© XXX 2015-2016
    </div>
    <div class="secondrow">
        <a href="https://github.com/gaoryrt/hexo-theme-pln">
        Theme Pln
        </a>
    </div>
</div>
<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.js"></script>
<script type="text/javascript">

// comments below to disable loading animation
function revealOnScroll() {
  var scrolled = $(window).scrollTop();
  $(".excerpt, .index-title, .index-meta, p").each(function() {
    var current = $(this),
      height = $(window).outerHeight(),
      offsetTop = current.offset().top;
    (scrolled + height + 50 > offsetTop) ? current.addClass("animation"):'';
  });
}
$(window).on("scroll", revealOnScroll);
$(document).ready(revealOnScroll)

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

// back to top scripts
$("a[href='#top']").click(function() {
  $("html, body").animate({ scrollTop: 0 }, 500);
  return false;
});


var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
